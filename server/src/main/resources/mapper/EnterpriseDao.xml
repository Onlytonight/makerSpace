<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qks.makerSpace.dao.EnterpriseDao">

    <select id="getOneEnterpriseById" resultType="com.qks.makerSpace.entity.Enterprise">
        select *
        from enterprise
        where enterprise_id = #{id}
    </select>

    <select id="getEnterpriseDetails" resultType="Map">
        select enterprise_id enterpriseId, team_name teamName
        from connect
        where employee_id = #{id}
    </select>

    <select id="getAllEnterprise" resultType="com.qks.makerSpace.entity.Enterprise">
        select enterprise_id enterpriseId, team_name teamName, head, phone, join_time joinTime, team_number teamNumber
        from enterprise
    </select>

    <select id="getEnterpriseByTeamName" resultType="com.qks.makerSpace.entity.Enterprise">
        select *
        from enterprise
        where team_name = #{teamName}
    </select>

    <insert id="addEnterprise" parameterType="Map">    
        insert into enterprise(enterprise_id, team_name, head, phone,
                               join_time, team_number, characteristic,
                               kind, field, achievements, scope, income,
                               tax, preferential_tax, tax_Free, support,
                               support_amount, risk_investment, investment_amount,
                               cooperation, project_name, project_amount,
                               high_tec, tec_sme)
        values (#{enterpriseId}, #{teamName}, #{head}, #{phone},
                #{joinTime}, #{teamNumber}, #{characteristic}, #{kind},
                #{field}, #{achievements}, #{scope}, #{income},
                #{tax}, #{preferentialTax}, #{taxFree}, #{support},
                #{supportAmount}, #{riskInvestment}, #{investmentAmount},
                #{cooperation},#{projectName}, #{projectAmount}, #{highTec},
                #{tecSme})
    </insert>

    <insert id="addConnect">
        insert into connect(id, team_name, enterprise_id)
        values (#{id}, #{teamName}, #{enterpriseId})
    </insert>

    <update id="updateEnterprise" parameterType="Map">
        update enterprise
        <set>
            <if test="teamName != null and teamName != ''">
                team_name = #{teamName}
            </if>
            <if test="head != null and head != ''">
                head = #{head}
            </if>
            <if test="phone != null and phone != ''">
                phone = #{phone}
            </if>
            <if test="joinTime != null and joinTime != ''">
                join_time = #{joinTime}
            </if>
            <if test="teamNumber != null and teamNumber != ''">
                team_number = #{teamNumber}
            </if>
            <if test="characteristic != null and characteristic != ''">
                characteristic = #{characteristic}
            </if>
            <if test="kind != null and kind != ''">
                kind = #{kind}
            </if>
            <if test="field != null and field != ''">
                field = #{field}
            </if>
            <if test="achievements != null and achievements != ''">
                achievements = #{achievements}
            </if>
            <if test="scope != null and scope != ''">
                scope = #{scope}
            </if>
            <if test="income != null and income != ''">
                income = #{income}
            </if>
            <if test="tax != null and tax != ''">
                tax = #{tax}
            </if>
            <if test="preferentialTax != null">
                preferential_tax = #{preferentialTax}
            </if>
            <if test="taxFree != null and taxFree != ''">
                tax_free = #{taxFree}
            </if>
            <if test="support != null">
                support = #{support}
            </if>
            <if test="supportAmount != null and supportAmount != ''">
                support_amount = #{supportAmount}
            </if>
            <if test="riskInvestment != null">
                risk_investment = #{riskInvestment}
            </if>
            <if test="investmentAmount != null and investmentAmount != ''">
                investment_amount = #{investmentAmount}
            </if>
            <if test="cooperation != null">
                cooperation = #{cooperation}
            </if>
            <if test="projectName != null and projectName != ''">
                project_name = #{projectName}
            </if>
            <if test="projectAount != null and projectAount != ''">
                project_aount = #{projectAount}
            </if>
            <if test="highTec != null">
                high_tec = #{highTec}
            </if>
            <if test="tec_sme">
                tec_sme = #{tecSme}
            </if>
        </set>
        where enterprise_id = #{enterpriseId}
    </update>

    <delete id="deleteEnterpriseAll">
        delete connect, enterprise, employee, property, activity
        from connect, enterprise, employee, property, activity
        where connect.enterprise_id = #{id}
        and connect.property_id = property.property_id
        and connect.employee_id = employee.employee_id
        and connect.activity_id = activity.activity_id
    </delete>
</mapper>